<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Shaka Packager SDK: shaka::media::SubsampleGenerator Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Shaka Packager SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/daf/namespaceshaka.html">shaka</a></li><li class="navelem"><b>media</b></li><li class="navelem"><a class="el" href="../../d0/d9f/classshaka_1_1media_1_1SubsampleGenerator.html">SubsampleGenerator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../de/d0a/classshaka_1_1media_1_1SubsampleGenerator-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">shaka::media::SubsampleGenerator Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../df/df8/subsample__generator_8h_source.html">subsample_generator.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a1674b4a68974db06ad4efa9a9b699a46"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d9f/classshaka_1_1media_1_1SubsampleGenerator.html#a1674b4a68974db06ad4efa9a9b699a46">SubsampleGenerator</a> (bool vp9_subsample_encryption)</td></tr>
<tr class="separator:a1674b4a68974db06ad4efa9a9b699a46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4478f9099344a05be5b9b3e4e209817"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d2/d20/classshaka_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d9f/classshaka_1_1media_1_1SubsampleGenerator.html#ac4478f9099344a05be5b9b3e4e209817">Initialize</a> (FourCC protection_scheme, const <a class="el" href="../../d5/db1/classshaka_1_1media_1_1StreamInfo.html">StreamInfo</a> &amp;stream_info)</td></tr>
<tr class="separator:ac4478f9099344a05be5b9b3e4e209817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d4d840fd11c1c89b8ed03cdf076c64e"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="../../d2/d20/classshaka_1_1Status.html">Status</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d9f/classshaka_1_1media_1_1SubsampleGenerator.html#a8d4d840fd11c1c89b8ed03cdf076c64e">GenerateSubsamples</a> (const uint8_t *frame, size_t frame_size, std::vector&lt; <a class="el" href="../../d1/d34/structshaka_1_1media_1_1SubsampleEntry.html">SubsampleEntry</a> &gt; *subsamples)</td></tr>
<tr class="separator:a8d4d840fd11c1c89b8ed03cdf076c64e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06ced910683c733b60f25521334b7472"><td class="memItemLeft" align="right" valign="top"><a id="a06ced910683c733b60f25521334b7472"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>InjectVpxParserForTesting</b> (std::unique_ptr&lt; <a class="el" href="../../db/dcb/classshaka_1_1media_1_1VPxParser.html">VPxParser</a> &gt; vpx_parser)</td></tr>
<tr class="separator:a06ced910683c733b60f25521334b7472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f01e0ec37af177ed40251729599f75c"><td class="memItemLeft" align="right" valign="top"><a id="a3f01e0ec37af177ed40251729599f75c"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>InjectVideoSliceHeaderParserForTesting</b> (std::unique_ptr&lt; <a class="el" href="../../dd/de4/classshaka_1_1media_1_1VideoSliceHeaderParser.html">VideoSliceHeaderParser</a> &gt; header_parser)</td></tr>
<tr class="separator:a3f01e0ec37af177ed40251729599f75c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d6c65401836a6248251cc02ad41626d"><td class="memItemLeft" align="right" valign="top"><a id="a6d6c65401836a6248251cc02ad41626d"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>InjectAV1ParserForTesting</b> (std::unique_ptr&lt; <a class="el" href="../../db/dc7/classshaka_1_1media_1_1AV1Parser.html">AV1Parser</a> &gt; av1_parser)</td></tr>
<tr class="separator:a6d6c65401836a6248251cc02ad41626d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Parsing and generating encryption subsamples from bitstreams. Note that the class can be used to generate subsamples from both audio and video bitstreams according to relevant specifications. For example, for video streams, the most notable specifications are Common Encryption v3 spec [1] and Apple SAMPLE AES spec [2]; for audio streams, they are full sample encrypted except for Apple SAMPLE AES spec, which usually contains leading clear bytes. [1] <a href="https://www.iso.org/standard/68042.html">https://www.iso.org/standard/68042.html</a> [2] <a href="https://apple.co/2Noi43q">https://apple.co/2Noi43q</a> </p>

<p class="definition">Definition at line <a class="el" href="../../df/df8/subsample__generator_8h_source.html#l00034">34</a> of file <a class="el" href="../../df/df8/subsample__generator_8h_source.html">subsample_generator.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a1674b4a68974db06ad4efa9a9b699a46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1674b4a68974db06ad4efa9a9b699a46">&#9670;&nbsp;</a></span>SubsampleGenerator()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">shaka::media::SubsampleGenerator::SubsampleGenerator </td>
          <td>(</td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>vp9_subsample_encryption</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vp9_subsample_encryption</td><td>determines if subsample encryption or full sample encryption is used for VP9. Only relevant for VP9 codec. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html#l00120">120</a> of file <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html">subsample_generator.cc</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a8d4d840fd11c1c89b8ed03cdf076c64e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d4d840fd11c1c89b8ed03cdf076c64e">&#9670;&nbsp;</a></span>GenerateSubsamples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d20/classshaka_1_1Status.html">Status</a> shaka::media::SubsampleGenerator::GenerateSubsamples </td>
          <td>(</td>
          <td class="paramtype">const uint8_t *&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>frame_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../d1/d34/structshaka_1_1media_1_1SubsampleEntry.html">SubsampleEntry</a> &gt; *&#160;</td>
          <td class="paramname"><em>subsamples</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates subsamples from the bitstream. Note that all frames should be processed by this function even if it is not encrypted as the next (encrypted) frame may be dependent on the previous clear frames. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">frame</td><td>points to the start of the frame. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">frame_size</td><td>is the size of the frame. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">subsamples</td><td>will contain the output subsamples on success. It will be empty if the frame should be full sample encrypted. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK on success, an error status otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html#l00210">210</a> of file <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html">subsample_generator.cc</a>.</p>

</div>
</div>
<a id="ac4478f9099344a05be5b9b3e4e209817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4478f9099344a05be5b9b3e4e209817">&#9670;&nbsp;</a></span>Initialize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d20/classshaka_1_1Status.html">Status</a> shaka::media::SubsampleGenerator::Initialize </td>
          <td>(</td>
          <td class="paramtype">FourCC&#160;</td>
          <td class="paramname"><em>protection_scheme</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/db1/classshaka_1_1media_1_1StreamInfo.html">StreamInfo</a> &amp;&#160;</td>
          <td class="paramname"><em>stream_info</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Initialize the generator. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">protection_scheme</td><td>is the protection scheme to be used for the encryption. It is used to determine if the protected data should be block aligned. </td></tr>
    <tr><td class="paramname">stream_info</td><td>contains stream information. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>OK on success, an error status otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html#l00125">125</a> of file <a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html">subsample_generator.cc</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>packager/media/crypto/<a class="el" href="../../df/df8/subsample__generator_8h_source.html">subsample_generator.h</a></li>
<li>packager/media/crypto/<a class="el" href="../../d7/d1e/subsample__generator_8cc_source.html">subsample_generator.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Tue Jun 22 2021 00:16:05 for Shaka Packager SDK by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
